<div class="col-md-12">
  <nz-spin nzTip="Veuillez patienter..." [nzSpinning]="isSpinning">

    <nz-collapse>
      <nz-collapse-panel *ngFor="let panel of search_panels" [nzHeader]="panel.name" [nzActive]="panel.active"
                         [nzDisabled]="panel.disabled">

        <form nz-form [formGroup]="searchValidateForm" (submit)="submitSearchForm()">
          <div class="row">
            <div class="col-md-6">
              <nz-form-label nzFor="regions">Régions</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="regions" [nzSize]="size" nzMode="tags"
                           nzPlaceHolder="Choisissez">
                  <nz-option *ngFor="let option of countries" [nzLabel]="option.name"
                             [nzValue]="option.id"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>

            <div class="col-md-6">
              <nz-form-label nzFor="skill_id">Compétences</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="skills" [nzSize]="size" nzMode="tags">
                  <nz-option *ngFor="let item of skills" nzValue="{{item.id}}"
                             nzLabel="{{item.name}}"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>

            <div class="col-md-6">
              <nz-form-label nzFor="degrees">Diplômes</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="degrees" [nzSize]="size" nzMode="tags">
                  <nz-option *ngFor="let item of degrees" nzValue="{{item.id}}"
                             nzLabel="{{item.name}}"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>

            <div class="col-md-6">
              <nz-form-label nzFor="sectors">Secteurs</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="sectors" [nzSize]="size" nzMode="tags"
                           nzPlaceHolder="Choisissez">
                  <nz-option *ngFor="let option of sectors" [nzLabel]="option.name"
                             [nzValue]="option.id"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>

            <div class="col-md-6">
              <nz-form-label nzFor="type_contracts">Type de contrats</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="type_contracts" [nzSize]="size" nzMode="tags"
                           nzPlaceHolder="Choisissez">
                  <nz-option nzValue="full_time" nzLabel="Temps plein"></nz-option>
                  <nz-option nzValue="part_time" nzLabel="Temps partiel"></nz-option>
                  <nz-option nzValue="independent" nzLabel="Indépendant"></nz-option>
                  <nz-option nzValue="freelance" nzLabel="Freelance"></nz-option>
                  <nz-option nzValue="cdd" nzLabel="CDD"></nz-option>
                  <nz-option nzValue="cdi" nzLabel="CDI"></nz-option>
                  <nz-option nzValue="internship" nzLabel="Stage"></nz-option>
                  <nz-option nzValue="study_contract" nzLabel="Contrat en alternance"></nz-option>
                  <nz-option nzValue="seasonal" nzLabel="Saisonnier"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>
            <div class="col-md-6">
              <nz-form-label nzFor="type_location">Type de lieux</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="type_location" [nzSize]="size" nzMode="tags"
                           nzPlaceHolder="Choisissez">
                  <nz-option nzValue="on_site" nzLabel="Sur site"></nz-option>
                  <nz-option nzValue="afar" nzLabel="À distance"></nz-option>
                  <nz-option nzValue="hybrid" nzLabel="Hybride"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>
            <div class="col-md-6">
              <nz-form-label nzFor="languages">Langues</nz-form-label>
              <nz-form-control>
                <nz-select formControlName="languages" [nzSize]="size" nzMode="tags"
                           nzPlaceHolder="Choisissez">
                  <nz-option nzValue="Anglais" nzLabel="Anglais"></nz-option>
                  <nz-option nzValue="Espagnol" nzLabel="Espagnol"></nz-option>
                  <nz-option nzValue="Français" nzLabel="Français"></nz-option>
                  <nz-option nzValue="Mandarin" nzLabel="Mandarin"></nz-option>
                  (chinois)
                  <nz-option nzValue="Hindi" nzLabel="Hindi"></nz-option>
                  <nz-option nzValue="Arabe" nzLabel="Arabe"></nz-option>
                  <nz-option nzValue="Bengali" nzLabel="Bengali"></nz-option>
                  <nz-option nzValue="Russe" nzLabel="Russe"></nz-option>
                  <nz-option nzValue="Portugais" nzLabel="Portugais"></nz-option>
                  <nz-option nzValue="Ourdou" nzLabel="Ourdou"></nz-option>
                  <nz-option nzValue="Allemand" nzLabel="Allemand"></nz-option>
                  <nz-option nzValue="Japonais" nzLabel="Japonais"></nz-option>
                  <nz-option nzValue="Swahili" nzLabel="Swahili"></nz-option>
                  <nz-option nzValue="Telugu" nzLabel="Telugu"></nz-option>
                  <nz-option nzValue="Marathi" nzLabel="Marathi"></nz-option>
                  <nz-option nzValue="Turc" nzLabel="Turc"></nz-option>
                  <nz-option nzValue="Tamil" nzLabel="Tamil"></nz-option>
                  <nz-option nzValue="Urdu" nzLabel="Urdu"></nz-option>
                  <nz-option nzValue="Coréen" nzLabel="Coréen"></nz-option>
                  <nz-option nzValue="Italien" nzLabel="Italien"></nz-option>
                  <nz-option nzValue="Punjabi" nzLabel="Punjabi"></nz-option>
                  <nz-option nzValue="Javanais" nzLabel="Javanais"></nz-option>
                  <nz-option nzValue="Wu" nzLabel="Wu"></nz-option>
                  (chinois)
                  <nz-option nzValue="Vietnamien" nzLabel="Vietnamien"></nz-option>
                  <nz-option nzValue="Cantonais" nzLabel="Cantonais"></nz-option>
                  (chinois)
                  <nz-option nzValue="Gujarati" nzLabel="Gujarati"></nz-option>
                  <nz-option nzValue="Pashto" nzLabel="Pashto"></nz-option>
                  <nz-option nzValue="Malayalam" nzLabel="Malayalam"></nz-option>
                  <nz-option nzValue="Sundanais" nzLabel="Sundanais"></nz-option>
                  <nz-option nzValue="Hausa" nzLabel="Hausa"></nz-option>
                  <nz-option nzValue="Farsi" nzLabel="Farsi"></nz-option>
                  (persan)
                  <nz-option nzValue="Birman" nzLabel="Birman"></nz-option>
                  <nz-option nzValue="Thaï" nzLabel="Thaï"></nz-option>
                  <nz-option nzValue="Ouzbek" nzLabel="Ouzbek"></nz-option>
                  <nz-option nzValue="Jin" nzLabel="Jin"></nz-option>
                  (chinois)
                  <nz-option nzValue="Yoruba" nzLabel="Yoruba"></nz-option>
                  <nz-option nzValue="Serbo-croate" nzLabel="Serbo-croate"></nz-option>
                  <nz-option nzValue="Malgache" nzLabel="Malgache"></nz-option>
                  <nz-option nzValue="Saraiki" nzLabel="Saraiki"></nz-option>
                  <nz-option nzValue="Népalais" nzLabel="Népalais"></nz-option>
                  <nz-option nzValue="Sarde" nzLabel="Sarde"></nz-option>
                  <nz-option nzValue="Khmer" nzLabel="Khmer"></nz-option>
                  (cambodgien)
                  <nz-option nzValue="Sinhala" nzLabel="Sinhala"></nz-option>
                  (singhalais)
                  <nz-option nzValue="Chhattisgarhi" nzLabel="Chhattisgarhi"></nz-option>
                  <nz-option nzValue="Zoulou" nzLabel="Zoulou"></nz-option>
                  <nz-option nzValue="Assamais" nzLabel="Assamais"></nz-option>
                  <nz-option nzValue="Madurais" nzLabel="Madurais"></nz-option>
                  <nz-option nzValue="Somali" nzLabel="Somali"></nz-option>
                  <nz-option nzValue="Marwari" nzLabel="Marwari"></nz-option>
                  <nz-option nzValue="Magahi" nzLabel="Magahi"></nz-option>
                </nz-select>
              </nz-form-control>
            </div>

            <div class="col-md-6">
              <div class="row">
                <div class="col-md-6">
                  <nz-form-label nzFor="year_exp_min">Année exp min</nz-form-label>
                  <nz-form-control>
                    <nz-input-group>
                      <input type="number" nz-input formControlName="year_exp_min" min="1"/>
                    </nz-input-group>
                  </nz-form-control>
                </div>
                <div class="col-md-6">
                  <nz-form-label nzFor="year_exp_max">Année exp max</nz-form-label>
                  <nz-form-control>
                    <nz-input-group>
                      <input type="number" nz-input formControlName="year_exp_max" min="1"/>
                    </nz-input-group>
                  </nz-form-control>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="row">
                <div class="col-md-6">
                  <nz-form-label nzFor="remunerations_min">Salaire min par mois</nz-form-label>
                  <nz-form-control>
                    <nz-input-group>
                      <input type="number" nz-input formControlName="remunerations_min" min="1"/>
                    </nz-input-group>
                  </nz-form-control>
                </div>
                <div class="col-md-6">
                  <nz-form-label nzFor="remunerations_max">Salaire max par mois</nz-form-label>
                  <nz-form-control>
                    <nz-input-group>
                      <input type="number" nz-input formControlName="remunerations_max" min="1"/>
                    </nz-input-group>
                  </nz-form-control>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <nz-form-label nzFor="">Lancer</nz-form-label>

              <button nz-button class="login-form-button login-form-margin col-md-12 "
                      [disabled]="!searchValidateForm.valid"
                      [nzType]="'primary'">
                Rechercher
              </button>
            </div>

          </div>
        </form>
      </nz-collapse-panel>
    </nz-collapse>

    <div *ngIf="offer" class="pt-4">
      <h5>Liste des candidats</h5>
      <nz-list class="demo-loadmore-list">
        <nz-list-item *ngFor="let item of offer.applies"
                      style="cursor: pointer;">
          <ng-container>
            <img src="assets/user-icon.png" alt="" width="60"
                 style="margin-right: 10px; border-radius: 50%">
            <nz-list-item-meta
              nzDescription="{{ item.user.identity.firstname }} {{ item.user.identity.lastname }}"
              (click)="showDetail(item)"
            >
              <nz-list-item-meta-title>

                <a href="javascript:void(0)"
                   class="text-primary">{{ item.user.user_degrees[0]["intitule"] }}</a>
                <br>
                <strong>Compétences</strong> : <span
                *ngFor="let item of item.user.user_skills"> {{item.skill.name}}
                ;</span>
                <br> Postulé le : {{item.created_at | date:'d/M/Y à HH:mm'}}
              </nz-list-item-meta-title>
            </nz-list-item-meta>
            <ul nz-list-item-actions>
              <nz-list-item-action>
                <a href="javascript:void(0)">
                  <nz-tag *ngIf="item.process_apply==null"
                          [nzColor]="'blue'">{{helperServiceFront.labelProcessApplyStatus(item.process_apply)}}</nz-tag>
                  <nz-tag *ngIf="item.process_apply!=null"
                          [nzColor]="'blue'">{{helperServiceFront.labelProcessApplyStatus(item.process_apply.step)}}</nz-tag>
                </a></nz-list-item-action>
              <nz-list-item-action><a href="javascript:void(0)" [routerLink]="['/apply-process',slug,item.id]">
                <span nz-icon nzType="delivered-procedure" nzTheme="outline"></span>
              </a></nz-list-item-action>
            </ul>

          </ng-container>

          <nz-skeleton
            *ngIf="item.loading"
            [nzActive]="true"
            [nzTitle]="false"
            [nzLoading]="true"
          ></nz-skeleton>
        </nz-list-item>

      </nz-list>


      <nz-drawer [nzBodyStyle]="{ overflow: 'auto' }" [nzMaskClosable]="false" [nzWidth]="720"
                 [nzVisible]="isModalSave" nzTitle="{{modalTitle}} "
                 (nzOnClose)="closeModal()" *ngIf="selected_cv">
        <form nz-form *nzDrawerContent [formGroup]="validateForm" (submit)="submitForm()">

          <div class="row">
            <div>
              <img src="assets/user-icon.png" alt="" style="border-radius: 50%; width: 25%">
            </div>
            <div>
              <h3>{{selected_cv.user.identity.firstname}} {{selected_cv.user.identity.lastname}} </h3>
              <span>{{selected_cv.user.identity.country.name}}
                , {{selected_cv.user.identity.address}}</span>
            </div>
            <div class="row mt-2">
              <div class="col-md-4">
                <div class="title">Email professionnel</div>
                <p>{{selected_cv.user.identity.email}}</p>
              </div>
              <div class="col-md-4">
                <div class="title">Téléphone</div>
                <p>{{selected_cv.user.identity.phone}}</p>
              </div>
              <div class="col-md-4">
                <div class="title">Situation matrimoniale</div>
                <p>{{helperServiceFront.labelMaritalStatus(selected_cv.user.identity.marital_status)}}</p>
              </div>

            </div>
            <div class="row mt-2">
              <div class="col-md-4">
                <div class="title">Date d'anniversaire</div>
                <p> {{selected_cv.user.identity.birthday | date:'d/M/Y'}}</p>
              </div>
              <div class="col-md-4">
                <div class="title">CV</div>
                <p><a class="login-form-forgot" title="" target="_blank"
                      href="{{storage_link+selected_cv.user.identity.cv}}">Consulter le cv</a>
                </p>
              </div>
              <div class="col-md-4">
                <div class="title">LinkedIn</div>
                <p>
                  <a class="login-form-forgot" title="" target="_blank"
                     href="{{selected_cv.user.identity.linkedin}}">Consulter le profil</a>
                </p>
              </div>

            </div>
          </div>

          <hr>
          <div class="row">
            <h4>Expériences</h4>
            <div>
              <nz-collapse>
                <nz-collapse-panel *ngFor="let panel of panels" [nzHeader]="panel.name"
                                   [nzActive]="panel.active"
                                   [nzDisabled]="panel.disabled">
                  <nz-list class="demo-loadmore-list">
                    <nz-list-item *ngFor="let item of selected_cv.user.experiences">
                      <ng-container>
                        <nz-list-item-meta
                          nzDescription="{{ item.begin }} à {{ item.end }}"
                        >
                          <nz-list-item-meta-title>
                            <a href="javascript:void(0)"
                               class="text-primary">{{ item.label }}</a> <br>
                            <a href="javascript:void(0)"
                               style="font-weight: bold">{{item.region.name}}
                              , {{ helperServiceFront.labelTypeWork(item.type_work) }}
                              , {{ helperServiceFront.labelTypeLocation(item.type_location) }}</a>
                            <div style="font-weight: bold">
                              {{ item.company }} - {{ item.sector.name }}
                            </div>
                            <div style="text-align: justify">
                              {{ item.description }}
                            </div>
                          </nz-list-item-meta-title>

                        </nz-list-item-meta>
                      </ng-container>

                      <nz-skeleton
                        *ngIf="item.loading"
                        [nzActive]="true"
                        [nzTitle]="false"
                        [nzLoading]="true"
                      ></nz-skeleton>
                    </nz-list-item>

                  </nz-list>
                </nz-collapse-panel>
              </nz-collapse>
            </div>
          </div>
          <hr>
          <div class="row">
            <h4>Diplômes</h4>
            <div>
              <nz-collapse>
                <nz-collapse-panel *ngFor="let panel of panels" [nzHeader]="panel.name"
                                   [nzActive]="panel.active"
                                   [nzDisabled]="panel.disabled">
                  <nz-list class="demo-loadmore-list">
                    <nz-list-item *ngFor="let item of  selected_cv.user.user_degrees">
                      <ng-container>
                        <nz-list-item-meta
                          nzDescription="{{ item.begin }} à {{ item.end }}"
                        >
                          <nz-list-item-meta-title>
                            <a href="javascript:void(0)"
                               class="text-primary">{{ item.degree.name }}</a> <br>
                            <a href="javascript:void(0)">{{ item.intitule }}
                              , {{ item.school }}
                              , {{ item.sector.name }}</a>
                          </nz-list-item-meta-title>
                        </nz-list-item-meta>
                      </ng-container>

                      <nz-skeleton
                        *ngIf="item.loading"
                        [nzActive]="true"
                        [nzTitle]="false"
                        [nzLoading]="true"
                      ></nz-skeleton>
                    </nz-list-item>
                  </nz-list>
                </nz-collapse-panel>
              </nz-collapse>
            </div>
          </div>
          <hr>
          <div class="row">
            <h4>Compétences</h4>
            <div>
              <nz-collapse>
                <nz-collapse-panel *ngFor="let panel of panels" [nzHeader]="panel.name"
                                   [nzActive]="panel.active"
                                   [nzDisabled]="panel.disabled">
                  <nz-list class="demo-loadmore-list">
                    <nz-list-item *ngFor="let item of  selected_cv.user.user_skills">
                      <ng-container>
                        <nz-list-item-meta
                        >
                          <nz-list-item-meta-title>
                            <a href="javascript:void(0)"><span
                              style="font-weight: bold">{{ item.skill.name }}</span>
                              : {{ item.year_exp }} an(s)</a>
                          </nz-list-item-meta-title>
                        </nz-list-item-meta>

                      </ng-container>

                      <nz-skeleton
                        *ngIf="item.loading"
                        [nzActive]="true"
                        [nzTitle]="false"
                        [nzLoading]="true"
                      ></nz-skeleton>
                    </nz-list-item>
                  </nz-list>
                </nz-collapse-panel>
              </nz-collapse>
            </div>
          </div>
          <hr>
          <div class="row">
            <h4>Lettre de motivation</h4>
            <div>
              <nz-collapse>
                <nz-collapse-panel *ngFor="let panel of panels" [nzHeader]="panel.name"
                                   [nzActive]="panel.active"
                                   [nzDisabled]="panel.disabled">

                  <div *ngIf="selected_cv.motivation!=null"> {{selected_cv.motivation}} </div>
                  <div *ngIf="selected_cv.motivation==null"> Pas de lettre de motivation </div>

                </nz-collapse-panel>
              </nz-collapse>
            </div>
          </div>

        </form>
      </nz-drawer>


    </div>

  </nz-spin>
</div>
